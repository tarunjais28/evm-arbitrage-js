require("dotenv").config();
const fs = require("fs");
const { decodeSwapFunction } = require("./src/uniswap");

const test = () => {
  let contracts;
  try {
    contracts = fs
      .readFileSync("resources/contracts.txt", "utf-8")
      .split("\n")
      .map((addr) => addr.trim().toLowerCase())
      .filter((addr) => addr.length > 0);
  } catch (error) {
    console.error("Error reading contracts file: resources/contracts.txt");
    console.error("Please make sure the file exists and is readable.");
    process.exit(1);
  }

  let tx = {
    data: "0x07ed23790000000000000000000000005141b82f5ffda4c6fe1e372978f1c5427640a190000000000000000000000000eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480000000000000000000000005141b82f5ffda4c6fe1e372978f1c5427640a1900000000000000000000000003b1c2b511a8ee394bce6b3d77395533d63abc9610000000000000000000000000000000000000000000000000001f438daa06000000000000000000000000000000000000000000000000000000000000013ef0e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001150000000000000000000000000000000000000000000000f700006800004e00a0744c8c0900000000000000000000000000000000000000004a183b7ed67b9e14b3f45abfb2cf44ed22c29e5400000000000000000000000000000000000000000000000000000400746fe0004041c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2d0e30db00c20c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2b4e16d0168e52d35cacd2c6185b44281ec28c9dc6ae4071138002dc6c0b4e16d0168e52d35cacd2c6185b44281ec28c9dc111111125421ca6dc452d289314280a0f8842a65000000000000000000000000000000000000000000000000000000000013ef0ec02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000006963f2b1",
    to: "0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D",
    from: "0xACBCB2724CFafb839C752d71997A8a7a16989b2e",
    value: "550000000000000",
    hash: "0xec79f0be131aa781eb98a2136fce0441b2de33fe99fad899b13eda6d306ef15b",
  };
  if (
    tx &&
    tx.data.length > 4 &&
    tx.to == "0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D"
  ) {
    decodeSwapFunction(tx, contracts);
  }
};

test();
